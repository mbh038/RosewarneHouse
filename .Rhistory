mypath="H:/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
cat(mypath,"grset")
cat(mypath,"/grset",sep="")
path="C:/temp/RSpace/PH525rawdata"
#mypath="H:/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
load(cat(path,"/grset",sep=""))
load(paste(path,"/grset",sep=""))
path="C:/temp/RSpace/PH525rawdata"
load(paste(path,"/grset",sep=""))
path="C:/users/Mike/RSpace/PH525rawdata"
#mypath="H:/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
load(paste(path,"/grset",sep=""))
paste(path,"/grset",sep="")
path="C:/Users/Mike/RSpace/PH525rawdata"
#mypath="H:/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
load(paste(path,"/grset",sep=""))
load("C:/users/Mike/RSpace/PH525rawdata/grset")
path="C:/Users/Mike/RSpace/PH525rawdata"
#mypath="H:/RSpace/PH525rawdata/PH525tcgaMethylationSubset-master"
load(paste(path,"/grset.rda",sep=""))
library(minfi)
class(grset)
pData(grset)
names(pData(grset))
names(pData(grset))
pData(grset)$pData(grset)
pData(grset)$characteristics_ch1.1
pData(grset)[1,]
pData(grset)[1,"characteristics_ch1.1"]
age=pData(grset)$characteristics_ch1.1
age=as.character(age)
age[grep("N/A",age)] = NA
age=as.numeric(gsub("age \\(y\\):\ ","",age))
group = rep("normal",nrow(pData(grset)))
group[grepl("ulcerative",pData(grset)[,1])]="ulcerative"
group[grepl("Crohn",pData(grset)[,1])]="crohn"
group = factor(group,levels=c("normal","ulcerative","crohn"))
keep = which(rowSums(is.na(getBeta(grset)))==0 &
!seqnames(grset)%in%c("chrX","chrY"))
##create a new object
grset2=grset[keep,]
grset2
d <- dist(t(grset2))
mds <- cmdscale(d)
mypar()
plot(mds[,1],mds[,2],bg=as.numeric(group),pch=21,
xlab="First dimension",ylab="Second dimension")
legend("bottomleft",levels(group),col=seq(along=levels(group)),pch=15)
d <- dist(t(grset2))
names(pData(grset))
dim(pData(grset))
dim(grset2)
str(grset2)
summary(grset2)
grset2[1,]
grset2[1,1]
assays(grset2)[1,]
assays(grset2)[[1]]
assays(grset2)[[1]][1,]
summary(assays(grset2))
str(assays(grset2))
d <- dist(t(assay(grset2))
d <- dist(t(assays(grset2)))
d <- dist(t(as.matrix(assays(grset2))))
class(assays(grset2))
class(grset)
s<-getbeta(grset2)
s<-getBeta(grset2)
rm(s)
d <- dist(t(getBeta(grset2))
)
mds <- cmdscale(d)
mypar()
plot(mds[,1],mds[,2],bg=as.numeric(group),pch=21,
library(rafalib)
library(rafalib)
mypar()
plot(mds[,1],mds[,2],bg=as.numeric(group),pch=21,
plot(mds[,1],mds[,2],bg=as.numeric(group),pch=21,xlab="First dimension",ylab="Second dimension")
legend("bottomleft",levels(group),col=seq(along=levels(group)),pch=as.numeric(group))
library(rafalib)
mypar()
plot(mds[,1],mds[,2],bg=as.numeric(group),pch=as.numeric(group),xlab="First dimension",ylab="Second dimension")
legend("bottomleft",levels(group),col=seq(along=levels(group)),pch=as.numeric(group))
d <- dist(t(getBeta(grset2)))
mds <- cmdscale(d)
library(rafalib)
mypar()
plot(mds[,1],mds[,2],col=as.numeric(group),pch=as.numeric(group),xlab="First dimension",ylab="Second dimension")
legend("bottomleft",levels(group),col=seq(along=levels(group)),pch=as.numeric(group))
plot(mds[,1],mds[,2],col=age,pch=as.numeric(group),xlab="First dimension",ylab="Second dimension")
legend("bottomleft",levels(group),col=seq(along=levels(group)),pch=as.numeric(group))
summary(age)
plot(mds[,1],mds[,2],col=ifelse(age>40,1,2),pch=as.numeric(group),xlab="First dimension",ylab="Second dimension")
legend("bottomleft",levels(group),col=seq(along=levels(group)),pch=as.numeric(group))
y = getBeta(grset2)
mds = cmdscale( dist( t(y)))
mypar(1,1)
col=ifelse(age>40,1,2)
plot(mds,pch=as.numeric(group),col=col)
legend("bottomleft",levels(group),pch=seq_along(group))
setwd("C:/Users/Mike/Rspace/RosewarneHouse")
u1<-read.csv("18-03-to-15-04 unit1.prn",sep="\t",stringsAsFactors=FALSE)
id<-seq(1,nrow(u1))
u1<-cbind(id,u1)
names(u1)<-c("id","date","time","T1","T2","T3","T4","hp1","hp2")
library(rafalib)
mypar(2,1)
plot(u1$T1,type="l") # inside
lines(u1$T2,col=2) # outside
lines(u1$T3,col=3) # inside
lines(u1$T4,col=4) # outside
u1$Tin=(u1$T1+u1$T3)/2
u1$dT1=u1$T1-u1$T2
u1$dT2=u1$T3-u1$T4
plot(u1$id,u1$dT1,type="l")
lines(u1$id,u1$dT2,col="red")
plot(u1$hp1,type="l")
lines(u1$hp2,col="red")
index1=u1$dT1>12
index2=u1$dT2>12
plot(u1$id[index1],u1$hp1[index1],type="l")
lines(u1$id[index2],u1$hp2[index2],col="red")
ampch1<-function(vout){
0.012 * vout - 0.094 #cal 5-02-16 alice & mike
}
ampch2<-function(vout){
0.0118 * vout - 0.5235 #cal 5-02-16 alice & mike
}
u1$hp1preamp1<-ampch1(u1$hp1)
u1$hp1flux1<-u1$hp1preamp1/0.06
u1$hp2preamp2<-ampch2(u1$hp2)
u1$hp2flux2<-u1$hp2preamp2/0.06
library(rafalib)
mypar(2,1)
plot(u1$T1[index1],u1$hp1flux1[index1],ylim=c(-10,20))
fit1<-lm(u1$hp1flux1[index1]~u1$T1[index1])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
plot(u1$T3[index2],u1$hp2flux2[index2],ylim=c(-10,20))
fit2<-lm(u1$hp2flux2[index2]~u1$T3[index2])
abline(fit2$coefficients[1],fit2$coefficients[2],col="red")
fit2$coefficients[2]
library(rafalib)
mypar(2,1)
plot(u1$dT1[index1],u1$hp1flux1[index1],ylim=c(-20,20))
fit3<-lm(u1$hp1flux1[index1]~u1$dT1[index1])
abline(fit3$coefficients[1],fit3$coefficients[2],col="red")
fit3$coefficients[2]
plot(u1$dT2[index2],u1$hp2flux2[index2],ylim=c(-20,20))
fit4<-lm(u1$hp2flux2[index2]~u1$dT2[index2])
abline(fit4$coefficients[1],fit4$coefficients[2],col="red")
fit4$coefficients[2]
u2<-read.csv("unit 2_5-02 p2.prn",sep="\t",stringsAsFactors=FALSE)
id<-seq(1,nrow(u2))
u2<-cbind(id,u2)
names(u2)<-c("id","date","time","T1","T2","T3","T4","hp1","hp2")
library(rafalib)
mypar(2,1)
plot(u2$T1,type="l") # inside
lines(u2$T2,col=2) # outside
lines(u2$T3,col=3) # inside
lines(u2$T4,col=4) # outside
u2$Tin=(u2$T1+u2$T3)/2
u2$dT1=u2$T1-u2$T2
u2$dT2=u2$T3-u2$T4
mypar(2,1)
plot(u2$id,u2$dT1,type="l")
lines(u2$id,u2$dT2,col="red")
plot(u2$hp1,type="l")
lines(u2$hp2,col="red")
index1=u2$hp1<100 & u2$id>10000 & u2$id<20000
index2=u2$hp2<100 & u2$id>10000 & u2$id<20000
plot(u2$id[index1],u2$hp1[index1],type="l")
lines(u2$id[index2],u2$hp2[index2],col="red")
plot(u2$hp1,type="l")
lines(u2$hp2,col="red")
ampch1<-function(vout){
0.012 * vout - 0.094 #cal 5-02-16 alice & mike
}
ampch2<-function(vout){
0.0118 * vout - 0.5235 #cal 5-02-16 alice & mike
}
u2$hp1preamp1<-ampch1(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch2(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
u2$hp1preamp1<-ampch2(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch1(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
u2$hp1preamp1<-ampch1(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch2(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
u2$hp1preamp1<-ampch1(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch1(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
u2$hp1preamp1<-ampch2(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch2(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
ampch1<-function(vout){
0.012 * vout + 0.094 #cal 5-02-16 alice & mike
}
ampch2<-function(vout){
0.0118 * vout + 0.5235 #cal 5-02-16 alice & mike
}
u2$hp1preamp1<-ampch1(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch2(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
ampch1<-function(vout){
0.012 * vout + 0.094 #cal 5-02-16 alice & mike
}
ampch2<-function(vout){
0.0118 * vout - 0.5235 #cal 5-02-16 alice & mike
}
u2$hp1preamp1<-ampch1(u2$hp1)
u2$hp1flux1<-u2$hp1preamp1/0.06
u2$hp2preamp2<-ampch2(u2$hp2)
u2$hp2flux2<-u2$hp2preamp2/0.06
plot(u2$id[index1],u2$hp1flux1[index1],type="l")
lines(u2$id[index2],u2$hp2flux2[index2],col="red")
mypar(2,1)
plot(u2$T1[index1],u2$hp1flux1[index1],ylim=c(-50,50))
fit1<-lm(u2$hp1flux1[index1]~u2$T1[index1])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
plot(u2$T3[index2],u2$hp2flux2[index2],ylim=c(-50,50))
fit2<-lm(u2$hp2flux2[index2]~u2$T3[index2])
abline(fit2$coefficients[1],fit2$coefficients[2],col="red")
fit2$coefficients[2]
library(rafalib)
mypar(2,1)
plot(u2$dT1[index1],u2$hp1flux1[index1],ylim=c(-20,20))
fit3<-lm(u2$hp1flux1[index1]~u2$dT1[index1])
abline(fit3$coefficients[1],fit3$coefficients[2],col="red")
fit3$coefficients[2]
plot(u2$dT2[index2],u2$hp2flux2[index2],ylim=c(-20,20))
fit4<-lm(u2$hp2flux2[index2]~u2$dT2[index2])
abline(fit4$coefficients[1],fit4$coefficients[2],col="red")
fit4$coefficients[2]
u3<-read.csv("26-02-to-18-03 unit3 2-3test.prn",sep="\t",stringsAsFactors=FALSE)
id<-seq(1,nrow(u3))
u3<-cbind(id,u3)
names(u3)<-c("id","date","time","T1","T2","T3","T4","hp1","hp2")
library(rafalib)
mypar(2,1)
plot(u3$T1,type="l") # inside
lines(u3$T2,col=2) # outside
lines(u3$T3,col=3) # inside
lines(u3$T4,col=4) # outside
u3$Tin=(u3$T1+u3$T3)/2
u3$dT1=u3$T1-u3$T2
u3$dT2=u3$T3-u3$T4
mypar(2,1)
plot(u3$id,u3$dT1,type="l")
lines(u3$id,u3$dT2,col="red")
plot(u3$hp1,type="l")
lines(u3$hp2,col="red")
index1=u3$dT1>11 & u3$id>10000 & u3$id<30000
index2=u3$dT2>11 & u3$id>10000 & u3$id<30000
plot(u3$id[index1],u3$hp1[index1],type="l")
lines(u3$id[index2],u3$hp2[index2],col="red")
plot(u3$hp1,type="l")
lines(u3$hp2,col="red")
ampch1<-function(vout){
0.012 * vout - 0.094 #cal 5-02-16 alice & mike
}
ampch2<-function(vout){
0.0118 * vout - 0.5235 #cal 5-02-16 alice & mike
}
u3$hp1preamp1<-ampch1(u3$hp1)
u3$hp1flux1<-u3$hp1preamp1/0.06
u3$hp2preamp2<-ampch2(u3$hp2)
u3$hp2flux2<-u3$hp2preamp2/0.06
#index=10000:20000
mypar(2,1)
plot(u3$T1[index1],u3$hp1flux1[index1],ylim=c(-50,50))
fit1<-lm(u3$hp1flux1[index1]~u3$T1[index1])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
plot(u3$T3[index2],u3$hp2flux2[index2],ylim=c(-50,50))
fit2<-lm(u3$hp2flux2[index2]~u3$T3[index2])
abline(fit2$coefficients[1],fit2$coefficients[2],col="red")
fit2$coefficients[2]
library(rafalib)
mypar(2,1)
plot(u3$dT1[index1],u3$hp1flux1[index1],ylim=c(-20,20))
fit3<-lm(u3$hp1flux1[index1]~u3$dT1[index1])
abline(fit3$coefficients[1],fit3$coefficients[2],col="red")
fit3$coefficients[2]
plot(u3$dT2[index2],u3$hp2flux2[index2],ylim=c(-20,20))
fit4<-lm(u3$hp2flux2[index2]~u3$dT2[index2])
abline(fit4$coefficients[1],fit4$coefficients[2],col="red")
fit4$coefficients[2]
mypar(2,1)
plot(u3$T1[index1],u3$hp1flux1[index1],ylim=c(-10,10))
fit1<-lm(u3$hp1flux1[index1]~u3$T1[index1])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
plot(u3$T3[index2],u3$hp2flux2[index2],ylim=c(-10,10))
fit2<-lm(u3$hp2flux2[index2]~u3$T3[index2])
abline(fit2$coefficients[1],fit2$coefficients[2],col="red")
fit2$coefficients[2]
### Unit 4
u4<-read.csv("22-04-to-29-04 unit4 final.prn",sep="\t",stringsAsFactors=FALSE)
names(u4)<-c("date","time","T1","T2","T3","T4","hp1","hp2")
library(rafalib)
mypar(2,1)
plot(u4$T1,type="l")
lines(u4$T2,col=2)
#lines(u4$T3,col=3)
lines(u4$T4,col=4)
u4$Tin=(u4$T1+u4$T2)/2
u4$dT=u4$Tin-u4$T4
index=2000:10000
ampch1<-function(vout){
0.012 * vout - 0.094 #cal 5-02-16 alice & mike
}
ampch2<-function(vout){
0.0118 * vout - 0.5235 #cal 5-02-16 alice & mike
}
u4$hp2preamp1<-ampch1(u4$hp2)
u4$hp2flux1<-u4$hp2preamp1/0.06
u4$hp2preamp2<-ampch2(u4$hp2)
u4$hp2flux2<-u4$hp2preamp2/0.06
plot(u4$Tin[index],u4$hp2flux2[index])
fit<-lm(u4$hp2flux1[index]~u4$Tin[index])
abline(fit$coefficients[1],fit$coefficients[2],col="red")
fit$coefficients[2]
plot(u4$Tin[index],u4$hp2flux2[index])
fit1<-lm(u4$hp1flux1[index]~u4$Tin[index])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
u4$hp1preamp1<-ampch1(u4$hp2)
u4$hp1flux1<-u4$hp1preamp1/0.06
u4$hp2preamp2<-ampch2(u4$hp2)
u4$hp2flux2<-u4$hp2preamp2/0.06
plot(u4$Tin[index],u4$hp2flux2[index])
fit1<-lm(u4$hp1flux1[index]~u4$Tin[index])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
plot(u4$Tin[index],u4$hp1flux1[index])
fit1<-lm(u4$hp1flux1[index]~u4$Tin[index])
abline(fit1$coefficients[1],fit1$coefficients[2],col="red")
fit1$coefficients[2]
plot(u4$Tin[index],u4$hp2flux2[index])
fit2<-lm(u4$hp2flux2[index]~u4$Tin[index])
abline(fit2$coefficients[1],fit2$coefficients[2],col="red")
fit2$coefficients[2]
